{% extends "base.html" %}

{% block scripts %}
{{super()}}
<script src="https://cdnjs.cloudflare.com/ajax/libs/showdown/1.7.6/showdown.min.js"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.2/rollups/aes.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.2/rollups/pbkdf2.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.2/components/mode-cfb.js"></script>

<script src="{{ url_for('static', filename='helpers/showdown_converter.js') }}"></script>
<script src="{{ url_for('static', filename='controllers/post.js') }}"></script>
<script src="{{ url_for('static', filename='controllers/dragAndDrop.js') }}"></script>
{% endblock %}

{% block styles %}
{{super()}}
<link href="{{ url_for('static', filename='css/post.css') }}" rel="stylesheet">
{% endblock %}

{% block body_attribs %}
ng-controller="mdBurst-api-post"
{% endblock %}

{% block content %}
{{super()}}
          <div class="mkdown_post container-fluid"  ng-cloak>
            <div class="row parent_post_result">
              <div class="col">
                <div class="post_result">
                  <div class="post_result_title">
                    <h3 ng-bind-html="post_title"></h3>
                  </div>
                  <div class="post_result_p" ng-bind-html="main_input_tohmtl">
                      {{main_input_tohmtl|angular}}
                  </div><!-- post_result_p -->
                </div><!-- post_result -->
              </div><!-- col -->

              <div class="col mkdown_input" imagedrop on-image-drop="imageDropped()">
                <form action="#" class="container-fluid">
                  <div class="mdl-textfield mdl-js-textfield">
                    <input class="mdl-textfield__input" ng-model="post_title" placeholder="Title" type="text">
                  </div>
                </form>

                <div class="container-fluid p_textarea">
                  <textarea
                    spellcheck="false"
                    placeholder="Write post here"
                    class="mui-textfield form-control ng-valid ng-dirty ng-valid-parse ng-touched"
                    ng-keyup="$event.keyCode === 13 && convert_showdown(main_input)"
                    ng-model="main_input">
                  </textarea>

                  <button type="button" class="mdl-button mdl-js-button mdl-button--raised mdl-button--accent" id="post_btn" ng-click=post_next_step(1)>
                    Post  <span class="glyphicon glyphicon-share"></span>
                  </button>
                </div>

                <div id="confirm_post">
                  <div id="post_confirm_step_1">
                    <button type="button" class="mdl-button mdl-js-button mdl-button--raised mdl-button--accent" id="cancel_btn" ng-click='post_next_step(-1)'>
                      Cancel  <span class="glyphicon glyphicon-share"></span>
                    </button>
                    <h4 id="select_category_t">Choississez une categorie</h4>


                    <div class="categories">
                      <div  class="render_category"
                            ng-repeat= "cat in list_category track by $index"
                            ng-click= "category_selected($index)">
                            <img class="img-rounded" src= "{{ url_for('static', filename='img/category/cat_') + '{{cat}}'+'.png'}}" >
                            *
                        <!-- {{cat|angular}} -->
                      </div><!-- category -->
                    </div><!-- categories -->
                  </div><!-- step_1 -->

                  <div id="post_confirm_step_2">
                    <form ng-submit="add_tag()">
                      <input type="text" placeholder="ajouter tag" ng-model="tag_value">
                    </form>

                    <!-- Deletable Chip -->
                    <div ng-bind-html="renderTagsHtml" id="renderTags"></div>

                    <div class="btn-group-justified post_confirm_bt">
                      <a href="#" class="btn btn-primary" ng-click='post_next_step(-1)'>cancel</a>
                      <a href="#" class="btn btn-primary" ng-click='post_next_step(1)'>confirm</a>
                    </div><!-- post_confirm -->
                  </div><!-- step_2 -->

                </div><!-- confirm_post -->
                <!-- 'postMD(post_title, main_input)' -->
              </div><!-- col -->
            </div><!-- row -->
          </div><!-- mkdown_input -->

          <dialog class="mdl-dialog">
            <h4 class="mdl-dialog__title">Post vide</h4>
            <div class="mdl-dialog__content">
              <p>
                Le post est vide!
              </p>
            </div>
            <div class="mdl-dialog__actions">
              <button type="button" class="mdl-button close">Ok</button>
            </div>
          </dialog>
{% endblock %}
